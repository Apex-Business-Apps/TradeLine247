import{j as e}from"./react-query-DHkNQnk-.js";import{r as s}from"./react-vendor-a1y4eqJD.js";import{z as a,F as r,C as t,d as l,f as i,T as n,h as d,g as c,B as m,n as x,i as o}from"./index-Dpo-kh1j.js";import{C as h}from"./circle-x-CEMfQcIp.js";import"./radix-primitives-BmowSk35.js";import"./radix-overlays-COL35z5_.js";import"./supabase-Ccy6tpTo.js";import"./react-router-DP697y4K.js";import"./radix-forms-DXrNnkJS.js";const u=()=>{const[u,j]=s.useState(!0),[p,g]=s.useState(null),[v,b]=s.useState(null);s.useEffect(()=>{f();const e=setInterval(f,3e4);return()=>clearInterval(e)},[]);const f=async()=>{try{const{data:e,error:s}=await a.from("messaging_compliance").select("*").eq("us_enabled",!0).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(s)throw s;g(e),b(null)}catch(e){console.error("Error loading A2P status:",e),b(e instanceof Error?e.message:"Failed to load A2P status")}finally{j(!1)}};return u?e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx("div",{className:"flex-1 container py-8",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading messaging health data..."})})}),e.jsx(r,{})]}):e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsxs("div",{className:"flex-1 container py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Messaging Health"}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor A2P 10DLC compliance, delivery rates, and SMS performance"})]}),v&&e.jsxs(t,{className:"mb-6 border-destructive",children:[e.jsx(l,{children:e.jsxs(i,{className:"flex items-center gap-2 text-destructive",children:[e.jsx(n,{className:"w-5 h-5"}),"Error Loading Data"]})}),e.jsx(d,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:v})})]}),!(null==p?void 0:p.us_enabled)&&e.jsxs(t,{className:"mb-6 border-blue-500",children:[e.jsx(l,{children:e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(n,{className:"w-5 h-5 text-blue-500"}),"US Messaging Not Enabled"]})}),e.jsx(d,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"This organization is configured for Canada-only messaging. US A2P 10DLC is not required."})})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(t,{children:[e.jsxs(l,{children:[e.jsx(i,{className:"text-lg",children:"A2P 10DLC Status"}),e.jsx(c,{children:"Brand & Campaign Verification"})]}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Overall Status"}),(s=>{if(!s)return e.jsx(m,{variant:"secondary",children:"Not Configured"});switch(s.toLowerCase()){case"verified":case"approved":return e.jsxs(m,{className:"bg-green-500",children:[e.jsx(o,{className:"w-3 h-3 mr-1"}),"Verified"]});case"pending":return e.jsxs(m,{variant:"outline",children:[e.jsx(x,{className:"w-3 h-3 mr-1"}),"Pending"]});case"rejected":case"failed":return e.jsxs(m,{variant:"destructive",children:[e.jsx(h,{className:"w-3 h-3 mr-1"}),"Failed"]});default:return e.jsx(m,{variant:"secondary",children:s})}})((null==p?void 0:p.a2p_status)||null)]}),(null==p?void 0:p.brand_sid)&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Brand SID"}),e.jsx("code",{className:"text-xs bg-muted px-2 py-1 rounded",children:p.brand_sid})]}),(null==p?void 0:p.campaign_sid)&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Campaign SID"}),e.jsx("code",{className:"text-xs bg-muted px-2 py-1 rounded",children:p.campaign_sid})]}),(null==p?void 0:p.messaging_service_sid)&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Messaging Service"}),e.jsx("code",{className:"text-xs bg-muted px-2 py-1 rounded",children:p.messaging_service_sid})]})]})]}),e.jsxs(t,{children:[e.jsxs(l,{children:[e.jsx(i,{className:"text-lg",children:"Delivery Performance"}),e.jsx(c,{children:"Last 24 Hours"})]}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Delivery Rate"}),e.jsx("div",{className:"text-2xl font-bold",children:(y=null==p?void 0:p.delivery_rate,y?y>=98?e.jsxs(m,{className:"bg-[hsl(142,85%,25%)] text-white",children:[y,"%"]}):y>=95?e.jsxs(m,{variant:"outline",className:"border-amber-600 text-amber-800",children:[y,"%"]}):e.jsxs(m,{variant:"destructive",children:[y,"%"]}):e.jsx(m,{variant:"secondary",children:"No Data"}))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Target: â‰¥98%"})]}),(null==p?void 0:p.last_delivery_receipt)&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Last Receipt"}),e.jsx("code",{className:"text-xs bg-muted px-2 py-1 rounded break-all",children:p.last_delivery_receipt})]})]})]}),e.jsxs(t,{children:[e.jsxs(l,{children:[e.jsx(i,{className:"text-lg",children:"Callback Performance"}),e.jsx(c,{children:"Status Webhook Latency"})]}),e.jsx(d,{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Avg Callback Time"}),e.jsx("div",{className:"text-2xl font-bold",children:(N=null==p?void 0:p.avg_callback_ms,N?N<500?e.jsxs(m,{className:"bg-[hsl(142,85%,25%)] text-white",children:[N,"ms"]}):N<1e3?e.jsxs(m,{variant:"outline",className:"border-amber-600 text-amber-800",children:[N,"ms"]}):e.jsxs(m,{variant:"destructive",children:[N,"ms"]}):e.jsx(m,{variant:"secondary",children:"No Data"}))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Target: <500ms"})]})})]})]}),(null==p?void 0:p.us_enabled)&&e.jsxs(t,{className:"mt-6",children:[e.jsxs(l,{children:[e.jsx(i,{children:"Compliance Samples"}),e.jsx(c,{children:"Opt-in, HELP, and STOP message templates"})]}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Sample Opt-in Message:"}),e.jsx("p",{className:"text-sm bg-muted p-3 rounded",children:'"Reply YES to receive updates from [Business Name]. Msg&Data rates may apply. Text STOP to unsubscribe, HELP for help."'})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Sample HELP Response:"}),e.jsx("p",{className:"text-sm bg-muted p-3 rounded",children:'"For support, contact us at +1-587-742-8885 or info@tradeline247ai.com. Text STOP to unsubscribe."'})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Sample STOP Response:"}),e.jsx("p",{className:"text-sm bg-muted p-3 rounded",children:'"You\'ve been unsubscribed and will receive no further messages from this number. Reply START to resubscribe."'})]})]})]}),e.jsxs(t,{className:"mt-6",children:[e.jsx(l,{children:e.jsx(i,{children:"Resources"})}),e.jsxs(d,{className:"space-y-2",children:[e.jsx("a",{href:"https://www.twilio.com/docs/sms/a2p-10dlc",target:"_blank",rel:"noopener noreferrer",className:"block text-sm text-primary hover:underline",children:"ðŸ“š Twilio A2P 10DLC Documentation"}),e.jsx("a",{href:"https://supabase.com/dashboard/project/hysvqdwmhxnblxfqnszn/editor/messaging_compliance",target:"_blank",rel:"noopener noreferrer",className:"block text-sm text-primary hover:underline",children:"ðŸ—„ï¸ View Compliance Records"})]})]})]}),e.jsx(r,{})]});var N,y};export{u as default};
