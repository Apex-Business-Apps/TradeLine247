import{j as e}from"./react-query-DHkNQnk-.js";import{r as s}from"./react-vendor-a1y4eqJD.js";import{a,D as t,o as n,p as l,w as r,J as i,K as c,C as m,d,f as o,g as x,h,j as p,i as u,z as j}from"./index-Dpo-kh1j.js";import{U as g}from"./users-DbQeiDhM.js";import{S as w}from"./send-BXSmw3Ye.js";import{u as f}from"./react-router-DP697y4K.js";import"./radix-primitives-BmowSk35.js";import"./radix-overlays-COL35z5_.js";import"./supabase-Ccy6tpTo.js";import"./radix-forms-DXrNnkJS.js";
/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N=a("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),y=a("file-down",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]),v=a("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]),b=a("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),S="c0000000-0000-0000-0000-000000000001";function C(){const a=f(),{user:C,isAdmin:k,loading:E}=t(),{toast:_}=n(),[F,I]=s.useState(null),[M,R]=s.useState({});if(s.useEffect(()=>{E||C||a(l.auth)},[E,C,a]),E)return e.jsx("div",{className:"container mx-auto p-6 max-w-4xl flex items-center justify-center min-h-[60vh]",children:e.jsx(r,{className:"h-8 w-8 animate-spin"})});if(!k())return e.jsx("div",{className:"container mx-auto p-6 max-w-4xl",children:e.jsxs(i,{variant:"destructive",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsxs(c,{children:[e.jsx("strong",{children:"Access Denied:"})," This page requires administrator privileges. Campaign management operations can only be performed by admins due to security requirements."]})]})});const L=async(e,s,a)=>{I(e);try{const{data:t,error:n}=await j.functions.invoke(s,{body:a});if(n)throw n;R(s=>({...s,[e]:t})),_({title:`âœ… ${e} Complete`,description:JSON.stringify(t,null,2).substring(0,200)})}catch(t){_({title:`âŒ ${e} Failed`,description:t.message,variant:"destructive"})}finally{I(null)}},G=async()=>{const e=await fetch("/warm_contacts_outreach.csv").then(e=>e.text());await L("Import Leads","ops-leads-import",{csv_content:e,list_name:"Warm Leads â€” Imported"})},J=async()=>{await L("Create Segment","ops-segment-warm50",{campaign_id:S,segment_size:50,seed_emails:["test@tradeline247.com"]})},z=async()=>{await L("Send Emails","ops-send-warm50",{campaign_id:S,max_sends:50,throttle_per_minute:30})},O=async()=>{await L("Enable Follow-ups","ops-followups-enable",{campaign_id:S,day3_enabled:!0,day7_enabled:!0})},q=async()=>{await L("Generate Report","ops-report-export",{campaign_id:S})};return e.jsxs("div",{className:"container mx-auto p-6 max-w-4xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"ðŸš€ Campaign Manager"}),e.jsx("p",{className:"text-muted-foreground",children:"Relaunch â€” Canada Campaign Workflow"})]}),e.jsx(i,{className:"mb-6",children:e.jsxs(c,{children:[e.jsx("strong",{children:"Campaign ID:"})," ",S,e.jsx("br",{}),e.jsx("strong",{children:"Status:"})," Ready to execute"]})}),e.jsxs(m,{className:"mb-6",children:[e.jsxs(d,{children:[e.jsx(o,{children:"Quick Execute"}),e.jsx(x,{children:"Run all steps in sequence automatically"})]}),e.jsx(h,{children:e.jsx(p,{onClick:async()=>{await G(),await J(),await z(),await O(),await q()},disabled:null!==F,className:"w-full",size:"lg",children:F?e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"mr-2 h-4 w-4 animate-spin"}),"Running: ",F,"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"mr-2 h-4 w-4"}),"Execute Complete Workflow"]})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(m,{children:[e.jsxs(d,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-5 w-5"}),"Step 1: Import Leads"]}),e.jsx(x,{children:'Import CSV and create "Warm Leads â€” Imported" list'})]}),e.jsxs(h,{children:[e.jsx(p,{onClick:G,disabled:null!==F,variant:"outline",className:"w-full",children:"Import Leads"===F?e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"mr-2 h-4 w-4 animate-spin"})," Importing..."]}):"Import Leads"}),M["Import Leads"]&&e.jsx("pre",{className:"mt-2 p-2 bg-muted rounded text-xs overflow-auto max-h-32",children:JSON.stringify(M["Import Leads"],null,2)})]})]}),e.jsxs(m,{children:[e.jsxs(d,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5"}),"Step 2: Create Segment"]}),e.jsx(x,{children:"Create Warm-50 segment with first 50 contacts"})]}),e.jsxs(h,{children:[e.jsx(p,{onClick:J,disabled:null!==F,variant:"outline",className:"w-full",children:"Create Segment"===F?e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"mr-2 h-4 w-4 animate-spin"})," Creating..."]}):"Create Segment"}),M["Create Segment"]&&e.jsx("pre",{className:"mt-2 p-2 bg-muted rounded text-xs overflow-auto max-h-32",children:JSON.stringify(M["Create Segment"],null,2)})]})]}),e.jsxs(m,{children:[e.jsxs(d,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-5 w-5"}),"Step 3: Send Emails"]}),e.jsx(x,{children:"Send 50 emails with throttling (â‰¤30/min)"})]}),e.jsxs(h,{children:[e.jsx(p,{onClick:z,disabled:null!==F,variant:"outline",className:"w-full",children:"Send Emails"===F?e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"mr-2 h-4 w-4 animate-spin"})," Sending..."]}):"Send Emails"}),M["Send Emails"]&&e.jsx("pre",{className:"mt-2 p-2 bg-muted rounded text-xs overflow-auto max-h-32",children:JSON.stringify(M["Send Emails"],null,2)})]})]}),e.jsxs(m,{children:[e.jsxs(d,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-5 w-5"}),"Step 4: Enable Follow-ups"]}),e.jsx(x,{children:"Schedule Day 3 & 7 follow-ups at 09:15 Vancouver time"})]}),e.jsxs(h,{children:[e.jsx(p,{onClick:O,disabled:null!==F,variant:"outline",className:"w-full",children:"Enable Follow-ups"===F?e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"mr-2 h-4 w-4 animate-spin"})," Enabling..."]}):"Enable Follow-ups"}),M["Enable Follow-ups"]&&e.jsx("pre",{className:"mt-2 p-2 bg-muted rounded text-xs overflow-auto max-h-32",children:JSON.stringify(M["Enable Follow-ups"],null,2)})]})]}),e.jsxs(m,{children:[e.jsxs(d,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5"}),"Step 5: Generate Report"]}),e.jsx(x,{children:"Export summary and CSV"})]}),e.jsxs(h,{children:[e.jsx(p,{onClick:q,disabled:null!==F,variant:"outline",className:"w-full",children:"Generate Report"===F?e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"mr-2 h-4 w-4 animate-spin"})," Generating..."]}):"Generate Report"}),M["Generate Report"]&&e.jsx("pre",{className:"mt-2 p-2 bg-muted rounded text-xs overflow-auto max-h-32",children:JSON.stringify(M["Generate Report"],null,2)})]})]})]})]})}export{C as default};
